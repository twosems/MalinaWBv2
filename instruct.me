üìö –ì–∞–π–¥: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–∏–ø–∞ —Ü–µ–Ω—ã –≤ –æ—Ç—á–µ—Ç–∞—Ö" (–ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
–ù–æ–≤–æ–µ –≤ –≤–µ—Ç–∫–µ:
–ì–ª–æ–±–∞–ª—å–Ω–æ–µ –º–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ—Ç—á—ë—Ç–æ–≤.

–í—ã–±–æ—Ä —Ç–∏–ø–∞ —Ü–µ–Ω—ã –¥–ª—è –≤—Å–µ—Ö –æ—Ç—á–µ—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ë–µ–∑ —Å–∫–∏–¥–æ–∫", "–°–æ —Å–∫–∏–¥–∫–æ–π –ø—Ä–æ–¥–∞–≤—Ü–∞", "–§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –¥–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—è", "–ö –≤—ã–ø–ª–∞—Ç–µ –ø—Ä–æ–¥–∞–≤—Ü—É").

–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –∏ –ø–æ–Ω—è—Ç–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –≥–∞–ª–æ—á–∫–∞–º–∏.

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤–æ –≤—Å–µ –æ—Ç—á—ë—Ç—ã Telegram-–±–æ—Ç–∞ –∏ —ç–∫—Å–ø–æ—Ä—Ç –≤ XLSX.

2. –ö—É–¥–∞ –∏ —á—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ —Ñ–∞–π–ª–∞–º
–∞) –ú–æ–¥–µ–ª—å –∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
–í SQL-–º–æ–¥–µ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (UserAccess –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ):

python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
price_type = Column(String, default="priceWithDisc")  # –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ø–æ–ª—è
–±) –í storage/users.py
–î–æ–±–∞–≤—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π:

python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
async def get_user_price_type(user_id: int) -> str:
    async with AsyncSessionLocal() as session:
        result = await session.execute(
            select(UserAccess.price_type).where(UserAccess.user_id == user_id)
        )
        row = result.first()
        return row[0] if row and row[0] else "priceWithDisc"

async def set_user_price_type(user_id: int, price_type: str):
    async with AsyncSessionLocal() as session:
        await session.execute(
            update(UserAccess)
            .where(UserAccess.user_id == user_id)
            .values(price_type=price_type)
        )
        await session.commit()
–≤) –í keyboards/keyboards.py
(–ó–¥–µ—Å—å –≤—Å–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏ —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —á–µ–ª–æ–≤–µ–∫–æ-—á–∏—Ç–∞–µ–º–æ–≥–æ –≤–∏–¥–∞ —Ü–µ–Ω—ã.)

python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
def price_type_human(t):
    return {
        "totalPrice": "–ë–µ–∑ —Å–∫–∏–¥–æ–∫",
        "priceWithDisc": "–°–æ —Å–∫–∏–¥–∫–æ–π –ø—Ä–æ–¥–∞–≤—Ü–∞",
        "finishedPrice": "–§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –¥–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—è",
        "forPay": "–ö –≤—ã–ø–ª–∞—Ç–µ –ø—Ä–æ–¥–∞–≤—Ü—É",
    }.get(t, t)

def sales_price_type_keyboard(current_type: str) -> InlineKeyboardMarkup:
    types = [
        ("totalPrice", "–ë–µ–∑ —Å–∫–∏–¥–æ–∫"),
        ("priceWithDisc", "–°–æ —Å–∫–∏–¥–∫–æ–π –ø—Ä–æ–¥–∞–≤—Ü–∞"),
        ("finishedPrice", "–§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –¥–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—è"),
        ("forPay", "–ö –≤—ã–ø–ª–∞—Ç–µ –ø—Ä–æ–¥–∞–≤—Ü—É"),
    ]
    ICON_SELECTED = "‚úÖ"
    ICON_UNSELECTED = "‚ùå"
    max_len = max(len(v) for _, v in types)
    def pad(text):
        return text + " " * (max_len - len(text) + 2)
    kb = [
        [
            InlineKeyboardButton(
                text=(f"{ICON_SELECTED}  {pad(v)}" if current_type == k else f"{ICON_UNSELECTED}  {pad(v)}"),
                callback_data=f"set_price_type:{k}"
            )
        ] for k, v in types
    ]
    kb.append([InlineKeyboardButton(text="‚¨ÖÔ∏è  –ù–∞–∑–∞–¥", callback_data="sales_report_settings")])
    return InlineKeyboardMarkup(inline_keyboard=kb)

def sales_report_settings_keyboard(current_price_type: str):
    return InlineKeyboardMarkup(inline_keyboard=[
        [
            InlineKeyboardButton(
                text="‚öôÔ∏è –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø —Ü–µ–Ω—ã –≤ –æ—Ç—á—ë—Ç–µ",
                callback_data="sales_price_type"
            )
        ],
        [
            InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data="main_reports")
        ]
    ])
–≥) –í handlers/report_settings.py
(–í—Å–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –º–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫.)

python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
from aiogram import Router, F
from aiogram.types import CallbackQuery
from aiogram.fsm.context import FSMContext
from storage.users import get_user_price_type, set_user_price_type
from bot.keyboards.keyboards import sales_report_settings_keyboard, sales_price_type_keyboard

router = Router()

@router.callback_query(F.data == "sales_report_settings")
async def sales_report_settings_menu(callback: CallbackQuery, state: FSMContext):
    user_id = callback.from_user.id
    price_type = await get_user_price_type(user_id)
    text = (
        "‚öôÔ∏è <b>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç—á—ë—Ç–æ–≤</b>\n\n"
        "üí∞ <b>–í–∏–¥ —Ü–µ–Ω</b> ‚Äî –≤—ã–±–∏—Ä–∞–π—Ç–µ, –∫–∞–∫–∏–µ —Ü–µ–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –≤ –æ—Ç—á—ë—Ç–∞—Ö (–æ–ø—Ç, —Ä–æ–∑–Ω–∏—Ü–∞ –∏ –ø—Ä.).\n"
        "üõí <b>–ê—Ä—Ç–∏–∫—É–ª—ã –ø—Ä–æ–¥–∞–≤—Ü–∞</b> ‚Äî –≤—Å–µ, –ª–∏–±–æ —Ç–æ–ª—å–∫–æ —Å –æ—Å—Ç–∞—Ç–∫–æ–º –Ω–∞ —Å–∫–ª–∞–¥–∞—Ö.\n"
        "üè¨ <b>–°–∫–ª–∞–¥—ã</b> ‚Äî –≤—Å–µ –∏–ª–∏ —Ç–æ–ª—å–∫–æ –≤–∞—à–∏.\n\n"
        "–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É üëá"
    )
    await callback.message.edit_text(
        text,
        reply_markup=sales_report_settings_keyboard(price_type),
        parse_mode="HTML"
    )

@router.callback_query(F.data == "sales_price_type")
@router.callback_query(F.data.startswith("set_price_type:"))
async def open_sales_price_type(callback: CallbackQuery, state: FSMContext):
    user_id = callback.from_user.id
    if callback.data.startswith("set_price_type:"):
        price_type = callback.data.split(":", 1)[1]
        await set_user_price_type(user_id, price_type)
    else:
        price_type = await get_user_price_type(user_id)
    await callback.message.edit_text(
        "<b>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ü–µ–Ω—ã –¥–ª—è –æ—Ç—á—ë—Ç–∞:</b>",
        reply_markup=sales_price_type_keyboard(price_type),
        parse_mode="HTML"
    )
–¥) –í –æ—Ç—á–µ—Ç–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, sales_by_articles.py, sales_by_warehouses.py)
–ü–æ–ª—É—á–∞–π —Ç–∏–ø —Ü–µ–Ω—ã –∏ —á–µ–ª–æ–≤–µ–∫–æ-—á–∏—Ç–∞–µ–º–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:

python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
from bot.keyboards.keyboards import price_type_human
price_type = await get_user_price_type(user_id)
price_type_name = price_type_human(price_type)
–ü–µ—Ä–µ–¥–∞–≤–∞–π –≤ —Ñ—É–Ω–∫—Ü–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
text, total_pages = format_sales_report(
    art, date_from, date_to, stat, price_type_name, page=page, page_size=PAGE_SIZE_REPORT
)
–í —à–∞–ø–∫–µ –æ—Ç—á—ë—Ç–∞ –∏ XLSX –≤—Å–µ–≥–¥–∞ –≤—ã–≤–æ–¥–∏ —Å—Ç—Ä–æ–∫—É:

python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
f"üí∂ –¶–µ–Ω–∞: {price_type_name}"
–∏

python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ws.append([f"–¶–µ–Ω–∞: {price_type_name}"])
3. README.md (–∫–∞–∫ –æ–ø–∏—Å–∞—Ç—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞)
markdown
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
## ‚öôÔ∏è –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç—á—ë—Ç–æ–≤ (–ú–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫)

–í —Ä–∞–∑–¥–µ–ª–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ—Ç—á—ë—Ç–æ–≤ —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å, –∫–∞–∫–æ–π —Ç–∏–ø —Ü–µ–Ω—ã –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤–æ –≤—Å–µ—Ö –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á—ë—Ç–∞—Ö –∏ —ç–∫—Å–ø–æ—Ä—Ç–∞—Ö:

- **–ë–µ–∑ —Å–∫–∏–¥–æ–∫** ‚Äî –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
- **–°–æ —Å–∫–∏–¥–∫–æ–π –ø—Ä–æ–¥–∞–≤—Ü–∞** ‚Äî —Ü–µ–Ω–∞ —Å —É—á—ë—Ç–æ–º —Å–∫–∏–¥–∫–∏ –ø—Ä–æ–¥–∞–≤—Ü–∞
- **–§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –¥–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—è** ‚Äî —Å —É—á—ë—Ç–æ–º –≤—Å–µ—Ö –ø—Ä–æ–º–æ-–∞–∫—Ü–∏–π
- **–ö –≤—ã–ø–ª–∞—Ç–µ –ø—Ä–æ–¥–∞–≤—Ü—É** ‚Äî –∏—Ç–æ–≥–æ–≤–∞—è –∫ –≤—ã–ø–ª–∞—Ç–µ

**–í—ã–±–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –æ—Ç—á—ë—Ç–∞–º Telegram-–±–æ—Ç–∞ –∏ –≤—ã–≥—Ä—É–∑–∫–µ –≤ XLSX!**

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ ¬´‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç—á—ë—Ç–æ–≤¬ª.
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç ¬´‚öôÔ∏è –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø —Ü–µ–Ω—ã –≤ –æ—Ç—á—ë—Ç–µ¬ª.
3. –û—Ç–º–µ—Ç—å—Ç–µ –Ω—É–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∏–ø –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂—ë–Ω –∑–µ–ª—ë–Ω–æ–π –≥–∞–ª–æ—á–∫–æ–π.
4. –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –≤—Å–µ –æ—Ç—á—ë—Ç—ã –±—É–¥—É—Ç —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å —ç—Ç–∏–º —Ç–∏–ø–æ–º —Ü–µ–Ω.

–í –æ—Ç—á—ë—Ç–∞—Ö (–∏ –≤ —Ñ–∞–π–ª–∞—Ö Excel) —Ç–µ–ø–µ—Ä—å –≤—Å–µ–≥–¥–∞ –µ—Å—Ç—å —Å—Ç—Ä–æ–∫–∞, –∏–Ω—Ñ–æ—Ä–º–∏—Ä—É—é—â–∞—è –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —Ç–∏–ø–µ —Ü–µ–Ω.

**–ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Äî —Ä–∞—Å—à–∏—Ä—è–π—Ç–µ —ç—Ç–æ—Ç –∂–µ —Ä–∞–∑–¥–µ–ª!**
üü¢ –ö—Ä–∞—Ç–∫–æ: –æ—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏
–ü–æ–ª–µ –≤ –ë–î –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–ì–µ—Ç—Ç–µ—Ä/—Å–µ—Ç—Ç–µ—Ä –≤ storage/users.py.

–ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏ —á–µ–ª–æ–≤–µ–∫–æ-—á–∏—Ç–∞–µ–º–æ–µ –∏–º—è –≤ keyboards/keyboards.py.

–•–µ–Ω–¥–ª–µ—Ä—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫ ‚Äî –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ handlers/report_settings.py.

–í –æ—Ç—á–µ—Ç–∞—Ö ‚Äî –≤—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞—Ç—å —Ç–∏–ø —Ü–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

–í XLSX-—ç–∫—Å–ø–æ—Ä—Ç–µ —Ç–∞–∫–∂–µ —É–∫–∞–∑—ã–≤–∞—Ç—å –≤–∏–¥ —Ü–µ–Ω—ã.

–í README.md ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª –¥–ª—è —ç—Ç–æ–π —Ñ–∏—á–∏.