MalinaWBv2: Highload-ready Telegram Bot
Tech stack: aiogram + Celery + Redis

üß≠ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –∫–ª—é—á–µ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
1. –°—Ç–µ–π—Ç –∏ API: –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å ‚Äî –≤–µ—Å—å –æ—Ç—á—ë—Ç
   –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –æ—Ç—á—ë—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–µ FSM-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

–ü–æ —Å–∫–ª–∞–¥—É: sales_report, warehouse_id, date_from, date_to

–ü–æ –≤—Å–µ–º —Å–∫–ª–∞–¥–∞–º: all_sales_report, all_warehouses, date_from, date_to

–ö Wildberries API –æ–±—Ä–∞—â–∞–µ–º—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –∑–∞ –ø–µ—Ä–∏–æ–¥ ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ FSM.

–í—Å–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º (–º–µ–Ω—é/–æ—Ç—á—ë—Ç–∞–º) –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ FSM, –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API.

2. –ü–∞–≥–∏–Ω–∞—Ü–∏—è: –ë–µ–∑ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
   –†–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–¥–∞—ë–º –ª–æ–∫–∞–ª—å–Ω–æ –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:

–ü–æ —Å–∫–ª–∞–¥—É: page_size = 30

–ü–æ –≤—Å–µ–º —Å–∫–ª–∞–¥–∞–º: PAGE_SIZE = 10

–ù–æ–≤—ã–π –æ—Ç—á—ë—Ç ‚Äî –Ω–æ–≤—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω, –ª–æ–∫–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã, –Ω–∏–∫–∞–∫–∏—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤.

3. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ UX: –ü—Ä–æ—Å—Ç–æ, —É–¥–æ–±–Ω–æ, —á–∏—Ç–∞–µ–º–æ
   –ü–æ —Å–∫–ª–∞–¥—É:
   ‚Äî –°–ø–∏—Å–æ–∫: <code>–∞—Ä—Ç–∏–∫—É–ª ‚Äî –∫–æ–ª-–≤–æ</code>
   ‚Äî –ò—Ç–æ–≥ –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: <b>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ</b>, <b>—Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂</b>

–ü–æ –≤—Å–µ–º —Å–∫–ª–∞–¥–∞–º:
‚Äî –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∫–ª–∞–¥–∞: –Ω–∞–∑–≤–∞–Ω–∏–µ, —Å–ø–∏—Å–æ–∫ –∞—Ä—Ç–∏–∫—É–ª–æ–≤, –∏—Ç–æ–≥ –ø–æ —Å–∫–ª–∞–¥—É (–∂–∏—Ä–Ω–æ), –µ—Å–ª–∏ –ø—É—Å—Ç–æ ‚Äî <i>–ù–µ—Ç –ø—Ä–æ–¥–∞–∂</i>

–ò—Ç–æ–≥–∏ –∏ —Å–ø–∏—Å–∫–∏ ‚Äî –≤—Å–µ–≥–¥–∞ –≤ —Ä–∞–∑–Ω—ã—Ö –±–ª–æ–∫–∞—Ö –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏.

–ò—Ç–æ–≥–∏: —Å—É–º–º—ã —Å –ø—Ä–æ–±–µ–ª–∞–º–∏ (243 475.69 ‚ÇΩ).

–ù–µ—Ç –ø—Ä–æ–¥–∞–∂ ‚Äî –≤—Å–µ–≥–¥–∞ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ <i>–ù–µ—Ç –ø—Ä–æ–¥–∞–∂ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –∞—Ä—Ç–∏–∫—É–ª–∞–º.</i>

4. –≠–∫—Å–ø–æ—Ä—Ç: –ê–∫—Ç—É–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç
   –î–ª—è –ª—é–±–æ–≥–æ –æ—Ç—á—ë—Ç–∞ –¥–æ—Å—Ç—É–ø–Ω—ã —ç–∫—Å–ø–æ—Ä—Ç –≤ CSV –∏ XLSX (Excel, —á–µ—Ä–µ–∑ openpyxl).

–í —à–∞–ø–∫–µ —Ñ–∞–π–ª–∞ ‚Äî –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥.

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∫–ª–∞–¥–∞ –∏–ª–∏ —Ç–∏–ø–∞ –æ—Ç—á—ë—Ç–∞ ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞.

5. –õ–æ–≥–∏–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π: –ß–∏—Å—Ç—ã–π —á–∞—Ç, –±–µ–∑ —Å–ø–∞–º–∞
   –ö–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –æ—Ç—á—ë—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ —á–∞—Ç —á–µ—Ä–µ–∑ .answer() ‚Äî —ç—Ç–æ –≤—Å–µ–≥–¥–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤–Ω–∏–∑—É.

–°—Ç–∞—Ç—É—Å—ã —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è/–æ–∂–∏–¥–∞–Ω–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ .edit_text() ‚Äî –Ω–∏–∫–∞–∫–∏—Ö "—à—É–º–Ω—ã—Ö" –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.

–§–∞–π–ª—ã (CSV/XLSX) –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º, –æ—Ç—á—ë—Ç—ã ‚Äî —Ç–æ–∂–µ –Ω–æ–≤—ã–º.

6. UX & –≤–∏–∑—É–∞–ª: –¢–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ
   –ù–æ–≤—ã–µ —Å—Ç–∞—Ç—É—Å—ã ‚Äî —Ç–æ–ª—å–∫–æ –∫–∞–∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.

–ò—Ç–æ–≥–∏ –∏ —Å–ø–∏—Å–∫–∏ –≤–∏–∑—É–∞–ª—å–Ω–æ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã.

–í—Å—ë –≤–∞–∂–Ω–æ–µ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, —Å—É–º–º—ã) ‚Äî –≤—ã–¥–µ–ª–µ–Ω–æ, –º–µ–ª–æ—á–∏ —Å–ø—Ä—è—Ç–∞–Ω—ã.

–ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã ‚Äî –≤—Å–µ–≥–¥–∞ –≤–∏–¥–µ–Ω, –∏—Ç–æ–≥–∏ –æ—Ç–¥–µ–ª—å–Ω–æ.

7. –û—à–∏–±–∫–∏: –¢–æ–ª—å–∫–æ –ø–æ –¥–µ–ª—É
   –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ API –∏–ª–∏ ratelimit ‚Äî –≤—ã–¥–∞—ë–º –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –æ—Ç—á—ë—Ç –Ω–µ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ.

–ü—Ä–∏ –±–æ–ª—å—à–∏—Ö –ø–µ—Ä–∏–æ–¥–∞—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤—ã–±–∏—Ä–∞—Ç—å –º–µ–Ω—å—à–µ –¥–∞—Ç.

8. –ü–∞—Ç—Ç–µ—Ä–Ω –Ω–æ–≤—ã—Ö –æ—Ç—á—ë—Ç–æ–≤
   –í—Å–µ –Ω–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –ª–∏–º–∏—Ç—ã, —Ñ–∏–ª—å—Ç—Ä—ã) ‚Äî —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ.

–ù–æ–≤—ã–π –æ—Ç—á—ë—Ç ‚Äî –ø–∞—Ç—Ç–µ—Ä–Ω:
–∑–∞–ø—Ä–æ—Å ‚Üí –∫—ç—à ‚Üí –∞–Ω–∞–ª–∏–∑ ‚Üí —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –≤—ã–≤–æ–¥ ‚Üí —ç–∫—Å–ø–æ—Ä—Ç

–ò—Ç–æ–≥–∏ –≤—Å–µ–≥–¥–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–º –±–ª–æ–∫–æ–º, —ç–∫—Å–ø–æ—Ä—Ç ‚Äî –ø–æ —à–∞–±–ª–æ–Ω—É.

9. –ü–æ–¥–¥–µ—Ä–∂–∫–∞: –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–π –ª–µ–≥–∫–æ
   –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü ‚Äî –≤—Å—ë —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ.

–ö–∞–∂–¥—ã–π —Ç–∏–ø –æ—Ç—á—ë—Ç–∞ ‚Äî —Å–≤–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫, –Ω–µ —Å–º–µ—à–∏–≤–∞—Ç—å!

–î–ª—è –Ω–æ–≤—ã—Ö ‚Äî –ø—Ä–æ—Å—Ç–æ –∫–æ–ø–∏—Ä—É–π –ø–∞—Ç—Ç–µ—Ä–Ω –≤—ã—à–µ.

üü¢ –ü—Ä–∏–º–µ—Ä –∫—Ä–∞—Å–∏–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞ –≤ Telegram
php-template
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
üì¶ –û—Ç—á—ë—Ç –ø–æ —Å–∫–ª–∞–¥—É: <b>–ö–æ–ª–µ–¥–∏–Ω–æ</b>
‚Ä¢ <code>art_123</code> ‚Äî <b>18</b> —à—Ç.
‚Ä¢ <code>art_111</code> ‚Äî <b>4</b> —à—Ç.
...
<b>–ò—Ç–æ–≥–æ:</b> <b>72</b> —à—Ç. / <b>243 475.69 ‚ÇΩ</b>
üìÇ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
–õ—é–±–æ–π –æ—Ç—á—ë—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π ‚Äî –≤ CSV/XLSX, —Ç–æ–ª—å–∫–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç.

–í —à–∞–ø–∫–µ ‚Äî –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

üè∑Ô∏è –†–∞–±–æ—Ç–∞ —Å –∞—Ä—Ç–∏–∫—É–ª–∞–º–∏ –∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏: Article Cache
–ß—Ç–æ —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
–ú–µ–Ω—é ¬´–í—Å–µ –∞—Ä—Ç–∏–∫—É–ª—ã¬ª –∏ ¬´–ê—Ä—Ç–∏–∫—É–ª—ã —Å –æ—Å—Ç–∞—Ç–∫–æ–º¬ª —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à (articles), –ª–∏–º–∏—Ç—ã WB API –Ω–µ —Ç—Ä–∞—Ç—è—Ç—Å—è.

–ö—ç—à –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ —Å–º–µ–Ω–µ API-–∫–ª—é—á–∞, –Ω–æ –Ω–µ —á–∞—â–µ –æ–¥–Ω–æ–≥–æ —Ä–∞–∑–∞ –≤ 30 –º–∏–Ω—É—Ç.

–ï—Å–ª–∏ –∫—ç—à —Å–≤–µ–∂–∏–π ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–Ω. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ API.

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
–ù–∏–∫–∞–∫–∏—Ö –ª–∏—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API Wildberries.

–õ—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Äî –≤—Å–µ–≥–¥–∞ –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–ª–∏–∫ –º–µ–Ω—é.

–ö—ç—à –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å–≤–µ–∂–∏–π, –Ω–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≥—Ä—É–∑–∏—Ç—Å—è —á–∞—â–µ, —á–µ–º –Ω—É–∂–Ω–æ.

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ
python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
from storage.articles import get_all_articles, get_in_stock_articles

# –í—Å–µ –∞—Ä—Ç–∏–∫—É–ª—ã –¥–ª—è –º–µ–Ω—é/–æ—Ç—á—ë—Ç–∞
arts = await get_all_articles(user_id)
# –¢–æ–ª—å–∫–æ —Å –æ—Å—Ç–∞—Ç–∫–æ–º
arts_in_stock = await get_in_stock_articles(user_id)
–î–ª—è –¥–µ–±–∞–≥–∞
–í –ª–æ–≥–∞—Ö —Ç–µ–ø–µ—Ä—å –≤–∏–¥–Ω–æ, —á—Ç–æ –∫—ç—à —Ä–µ–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:

csharp
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
[ARTICLES] all_articles_page: –≤–∑—è—Ç–æ N –∞—Ä—Ç–∏–∫—É–ª–æ–≤ –∏–∑ –±–∞–∑—ã –¥–ª—è user_id=...
[ARTICLES] in_stock_articles_page: –≤–∑—è—Ç–æ M –∞—Ä—Ç–∏–∫—É–ª–æ–≤ —Å –æ—Å—Ç–∞—Ç–∫–æ–º –∏–∑ –±–∞–∑—ã –¥–ª—è user_id=...
–ë—ã—Å—Ç—Ä–æ. –ù–∞–¥—ë–∂–Ω–æ. –ë–µ–∑ —Ä–∏—Å–∫–∞ –ø–æ –ª–∏–º–∏—Ç–∞–º.
–í–µ—Å—å –æ—Ç—á—ë—Ç –ø–æ –∞—Ä—Ç–∏–∫—É–ª–∞–º ‚Äî —Ç–µ–ø–µ—Ä—å —á–µ—Ä–µ–∑ –≤–∞—à Article Cache.

üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
–¢–∞–±–ª–∏—Ü–∞ articles:

id ‚Äî –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç, –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á

user_id ‚Äî Telegram user_id

supplier_article ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∞—Ä—Ç–∏–∫—É–ª (supplierArticle WB)

in_stock ‚Äî –æ—Å—Ç–∞—Ç–æ–∫: True/False

updated_at ‚Äî –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

sql
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
CREATE TABLE articles (
id SERIAL PRIMARY KEY,
user_id BIGINT NOT NULL,
supplier_article TEXT NOT NULL,
in_stock BOOLEAN DEFAULT FALSE,
updated_at TIMESTAMP DEFAULT NOW()
);
üß© –ü—Ä–∏–º–µ—Ä—ã SQL/ORM-–∑–∞–ø—Ä–æ—Å–æ–≤
python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
# –í—Å–µ –∞—Ä—Ç–∏–∫—É–ª—ã:
select(Article.supplier_article).where(Article.user_id == user_id)

# –¢–æ–ª—å–∫–æ —Å –æ—Å—Ç–∞—Ç–∫–æ–º:
select(Article.supplier_article).where(Article.user_id == user_id, Article.in_stock == True)

# –¢–æ–ª—å–∫–æ –±–µ–∑ –æ—Å—Ç–∞—Ç–∫–∞:
select(Article.supplier_article).where(Article.user_id == user_id, Article.in_stock == False)
üìù –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –≤—ã–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤ (WB API)
python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
import aiohttp
import asyncio
import json

API_KEY = "–í–ê–®_API_–ö–õ–Æ–ß"
WAREHOUSE_NAME = "–ö–æ–ª–µ–¥–∏–Ω–æ"
DATE_FROM = "2025-07-01T00:00:00"
DATE_TO = "2025-07-24T23:59:59"

async def fetch_orders(date_from):
url = "https://statistics-api.wildberries.ru/api/v1/supplier/orders"
headers = {"Authorization": API_KEY}
params = {"dateFrom": date_from}
async with aiohttp.ClientSession() as session:
async with session.get(url, headers=headers, params=params) as resp:
if resp.status != 200:
print(f"–û—à–∏–±–∫–∞: {resp.status}")
return []
return await resp.json()

async def get_all_orders():
orders = []
date_from = DATE_FROM
while True:
batch = await fetch_orders(date_from)
if not batch:
break
filtered = [
order for order in batch
if order.get("warehouseName") == WAREHOUSE_NAME and
DATE_FROM <= order.get("date", "") <= DATE_TO
]
orders.extend(filtered)
if len(batch) == 0 or len(batch) < 80000:
break
date_from = batch[-1]["lastChangeDate"]
return orders

async def main():
orders = await get_all_orders()
print(f"–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤ –ø–æ —Å–∫–ª–∞–¥—É '{WAREHOUSE_NAME}': {len(orders)}")
with open("all_orders.json", "w", encoding="utf-8") as f:
json.dump(orders, f, ensure_ascii=False, indent=2)

if __name__ == "__main__":
asyncio.run(main())
üß¨ –ì–ª–∞–≤–Ω–æ–µ ‚Äî –ø–∞—Ç—Ç–µ—Ä–Ω
–û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å ‚Äî –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç—á—ë—Ç–∞.

–í—Å—ë –º–µ–Ω—é, –æ—Ç—á—ë—Ç—ã, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ —Å –∫—ç—à–µ–º –∏ FSM.

–í –±–∞–∑–µ –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∞—Ä—Ç–∏–∫—É–ª–æ–≤.

–î–ª—è –ª—é–±–æ–≥–æ –Ω–æ–≤–æ–≥–æ –æ—Ç—á—ë—Ç–∞:
–∑–∞–ø—Ä–æ—Å ‚Üí –∫—ç—à ‚Üí –∞–Ω–∞–ª–∏–∑ ‚Üí —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –≤—ã–≤–æ–¥ ‚Üí —ç–∫—Å–ø–æ—Ä—Ç

–°–¥–µ–ª–∞–Ω–æ –±—ã—Å—Ç—Ä–æ, —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥—ë–∂–Ω–æ, —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –ª–µ–≥–∫–æ.
MalinaWBv2: highload-ready by design.

–ü–æ–ª—å–∑—É–π—Å—è —ç—Ç–∏–º README –∫–∞–∫ —ç—Ç–∞–ª–æ–Ω–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π –∏ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã, –∏ –¥–ª—è –±—É–¥—É—â–∏—Ö —Ñ–∏—á!
–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –µ—â—ë –Ω–∞ –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∏–µ –±–ª–æ–∫–∏ ‚Äî –ø–∏—à–∏, –ø–æ–¥–µ–ª—é –∏–ª–∏ –¥–æ–±–∞–≤–ª—é –∞–∫—Ü–µ–Ω—Ç—ã.
## ‚öôÔ∏è –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç—á—ë—Ç–æ–≤ (–ú–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫)

–í —Ä–∞–∑–¥–µ–ª–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ—Ç—á—ë—Ç–æ–≤ —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å, –∫–∞–∫–æ–π —Ç–∏–ø —Ü–µ–Ω—ã –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤–æ –≤—Å–µ—Ö –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á—ë—Ç–∞—Ö –∏ —ç–∫—Å–ø–æ—Ä—Ç–∞—Ö:

- **–ë–µ–∑ —Å–∫–∏–¥–æ–∫** ‚Äî –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
- **–°–æ —Å–∫–∏–¥–∫–æ–π –ø—Ä–æ–¥–∞–≤—Ü–∞** ‚Äî —Ü–µ–Ω–∞ —Å —É—á—ë—Ç–æ–º —Å–∫–∏–¥–∫–∏ –ø—Ä–æ–¥–∞–≤—Ü–∞
- **–§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –¥–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—è** ‚Äî —Å —É—á—ë—Ç–æ–º –≤—Å–µ—Ö –ø—Ä–æ–º–æ-–∞–∫—Ü–∏–π
- **–ö –≤—ã–ø–ª–∞—Ç–µ –ø—Ä–æ–¥–∞–≤—Ü—É** ‚Äî –∏—Ç–æ–≥–æ–≤–∞—è –∫ –≤—ã–ø–ª–∞—Ç–µ

**–í—ã–±–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –æ—Ç—á—ë—Ç–∞–º Telegram-–±–æ—Ç–∞ –∏ –≤—ã–≥—Ä—É–∑–∫–µ –≤ XLSX!**

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ ¬´‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç—á—ë—Ç–æ–≤¬ª.
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç ¬´‚öôÔ∏è –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø —Ü–µ–Ω—ã –≤ –æ—Ç—á—ë—Ç–µ¬ª.
3. –û—Ç–º–µ—Ç—å—Ç–µ –Ω—É–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∏–ø –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂—ë–Ω –∑–µ–ª—ë–Ω–æ–π –≥–∞–ª–æ—á–∫–æ–π.
4. –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –≤—Å–µ –æ—Ç—á—ë—Ç—ã –±—É–¥—É—Ç —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å —ç—Ç–∏–º —Ç–∏–ø–æ–º —Ü–µ–Ω.

–í –æ—Ç—á—ë—Ç–∞—Ö (–∏ –≤ —Ñ–∞–π–ª–∞—Ö Excel) —Ç–µ–ø–µ—Ä—å –≤—Å–µ–≥–¥–∞ –µ—Å—Ç—å —Å—Ç—Ä–æ–∫–∞, –∏–Ω—Ñ–æ—Ä–º–∏—Ä—É—é—â–∞—è –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —Ç–∏–ø–µ —Ü–µ–Ω.

**–ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Äî —Ä–∞—Å—à–∏—Ä—è–π—Ç–µ —ç—Ç–æ—Ç –∂–µ —Ä–∞–∑–¥–µ–ª!**
